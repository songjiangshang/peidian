(window["webpackJsonp_pms-framework-nx-umms-ui"]=window["webpackJsonp_pms-framework-nx-umms-ui"]||[]).push([["chunk-00bd3782"],{"00c3":function(e,t,a){"use strict";a("33ce")},"0358":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"model-content"},[a("versionTree",{staticClass:"model-left",on:{handleNodeClick:e.handleNodeClick}}),a("versionDetail",{staticClass:"model-right",attrs:{params:e.params}})],1)},i=[],s=a("fb55"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("versionCard",{attrs:{params:e.params},on:{change:e.cardChange}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"right-card-version"},[a("div",{staticClass:"card1"},[a("span",{staticStyle:{"font-size":"18px","font-weight":"bold","margin-left":"15px","margin-top":"10px",display:"inline-block"}},[e._v("变更内容描述")]),a("div",{staticClass:"content"},[a("el-form",{attrs:{"label-position":"left",inline:""}},[a("el-col",{staticClass:"col-befor",attrs:{offset:1,span:6}},[a("el-form-item",{attrs:{label:"版本号:"}},[a("div",{staticClass:"col-content"},[e._v(e._s(e.data.applyVersion))])])],1),a("el-col",{staticClass:"col-befor",attrs:{span:6}},[a("el-form-item",{attrs:{label:"类型:"}},[a("div",{staticClass:"col-content"},[e._v(" "+e._s(0==e.data.operStatus?"新增":"迭代")+" ")])])],1),a("el-col",{staticClass:"col-befor",attrs:{span:6}},[a("el-form-item",{attrs:{label:"变更人:"}},[a("div",{staticClass:"col-content"},[e._v(e._s(e.data.applyUserName))])])],1),a("el-col",{attrs:{span:5}},[e._v(" ")]),a("el-col",{staticClass:"col-befor",attrs:{span:12,offset:1}},[a("el-form-item",{attrs:{label:"发布时间:"}},[a("div",{staticClass:"col-content"},[e._v(e._s(e.data.pubTime))])])],1)],1)],1)]),a("div",{staticClass:"card2"},[a("span",{staticStyle:{"font-size":"18px","font-weight":"bold","margin-left":"15px","margin-top":"10px",display:"inline-block"}},[e._v("变更内容图示")]),a("div",{staticStyle:{border:"1px solid #ccc",width:"60%",margin:"0 auto",background:"#e8eff8"}},[a("div",{staticStyle:{"text-align":"center",margin:"0 auto","line-height":"30px",height:"30px",border:"1px solid #90bae6"}},[e._v(" "+e._s(e.data.modelTable+"  "+e.data.modelName)+" ")]),e._l(e.tableArr,(function(t,n){return a("div",{key:n,staticStyle:{height:"30px"}},[a("span",{staticClass:"content",style:{"background-color":t.color}},[e._v(e._s(t.name))]),a("span",{staticClass:"content",style:{"background-color":t.color}},[e._v(e._s(t.value))])])}))],2),e._m(0)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"right-card-version"},[a("div",{staticClass:"text"},[e._v("暂无数据")])])],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"colorDisk"},[a("p",[a("span"),e._v("橙色代表修改")]),a("p",[a("span"),e._v("红色代表新增")])])}],l=(a("d3b7"),a("159b"),a("99af"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"card-content"},[e.name?a("p",{staticClass:"card-title"},[e._v(e._s(e.name))]):e._e(),e.list.length>0?a("el-timeline",e._l(e.list,(function(t,n){return a("el-timeline-item",{key:n,attrs:{color:e.colors(n,e.index),placement:"top"}},[a("el-card",{staticClass:"my-card",class:{background:n===e.index},attrs:{shadow:"hover"},nativeOn:{click:function(a){return e.cardClick(n,t)}}},[a("p",[e._v(e._s(t.recordTime))]),a("p",{staticClass:"p-version"},[e._v("版本："+e._s(t.applyVersion))]),a("p",[a("span",{staticStyle:{"margin-right":"15px"}},[e._v("类型："+e._s(1==t.operStatus?"迭代":"新增"))]),a("span",[e._v("变更人："+e._s(t.applyUserName))])])])],1)})),1):a("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[a("div",{staticStyle:{"margin-top":"300px"}},[e._v("暂无数据")])])],1)}),c=[],d=(a("b0c0"),{props:{listData:{type:Object,default:function(){return{}}},params:{type:Object,default:function(){return{}}}},data:function(){return{index:0,list:[],name:null,loading:!1}},watch:{params:{handler:function(){console.log(this.params.belongLevel,"this.params.belongLevel"),"3"==this.params.belongLevel?(this.index=0,this.name=this.params.name,this.getVersionCard(this.params.code)):(this.name=null,this.list=[])},deep:!0}},mounted:function(){var e=this;this.getCard=function(t){return e.$http.get("".concat(e.$api.PRE,"/model-change-analysis/v1/get/modelChangeAnalysis/list"),{params:t})}},methods:{cardClick:function(e,t){this.$emit("change",e,t),this.index=e},getVersionCard:function(e){var t=this;this.loading=!0,this.getCard({modelCode:e}).then((function(e){t.loading=!1,t.list=e.data.data,t.list.length>0&&t.$emit("change",t.index,t.list[0])})).catch((function(){t.loading=!1}))},colors:function(e,t){return e==t?"#0a8588":"#f3f3f3"}}}),u=d,h=(a("3def"),a("2877")),p=Object(h["a"])(u,l,c,!1,null,"2fa9ea38",null),m=p.exports,f={components:{versionCard:m},props:{params:{type:Object,default:function(){return{}}}},watch:{params:function(){this.isShow=!1,this.params.modelCode&&this.getVersionDetail()}},mounted:function(){var e=this;this.getDetail=function(t){return e.$http.get("".concat(e.$api.PRE,"/model-change-analysis/v1/get/modelChangeAnalysisDetail"),{params:t})}},data:function(){return{datagridOptions:this.initDataGridOptions({a:""}),loading:!1,data:{},tableData:[],tableArr:[],isShow:!1}},methods:{cardChange:function(e,t){var a=this;this.loading=!0,this.getDetail({modelCode:t.modelCode,objId:t.objId}).then((function(e){a.isShow=!0,a.loading=!1,a.tableArr=[],a.data=e.data.data,a.tableData=JSON.parse(e.data.data.changeMessageJson),a.tableData.forEach((function(e,t){var n="";n=0==e.operType?"#ff0000":"#ee7c31",console.log(e,"itemitemitem"),a.tableArr.push({name:"".concat(e.columnName,"（").concat(e.columnComments,"）"),value:"".concat(e.dataType,"（").concat(e.dataLength,"）"),color:n})}))}))},getVersionDetail:function(){this.verSionDetail({modelCode:this.params.modelCode})},initDataGridOptions:function(){this.datagridOptions={data:[]}}}},v=f,g=(a("c79d"),Object(h["a"])(v,o,r,!1,null,"c1638f0a",null)),C=g.exports,b={components:{versionTree:s["a"],versionDetail:C},data:function(){return{params:{}}},methods:{handleNodeClick:function(e,t){this.params=t}}},_=b,x=(a("00c3"),Object(h["a"])(_,n,i,!1,null,"464c4355",null));t["default"]=x.exports},"0e1a":function(e,t,a){},"33ce":function(e,t,a){},"3def":function(e,t,a){"use strict";a("0e1a")},"63bd":function(e,t,a){"use strict";a("7c96")},"7c96":function(e,t,a){},9536:function(e,t,a){},c740:function(e,t,a){"use strict";var n=a("23e7"),i=a("b727").findIndex,s=a("44d2"),o="findIndex",r=!0;o in[]&&Array(1)[o]((function(){r=!1})),n({target:"Array",proto:!0,forced:r},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},c79d:function(e,t,a){"use strict";a("9536")},fb55:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",staticStyle:{position:"relative"}},[e._m(0),a("div",{staticClass:"block"},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.treeKey,ref:"tree",attrs:{"icon-class":"el-icon-arrow-right",props:e.defaultProps,"node-key":"code","highlight-current":"",data:e.treeData},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(" "+e._s(n.label))])])}}])})],1)])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-tree"},[a("div",{staticClass:"treebox-header-style"},[a("span",{staticClass:"vertical-bar"}),a("p",{staticClass:"treebox-title"},[e._v("模型变更")])])])}],s=(a("d3b7"),a("159b"),a("a434"),a("c740"),{components:{},data:function(){return{menuVisible:!1,nodeData:{},chacheName:[],treeKey:"",loading:!0,pageX:0,treeData:[],defaultProps:{children:"children",label:"name"}}},created:function(){var e=this;this.getTree=function(t){return e.$http.get("".concat(e.$api.PRE,"/logicModel/navigation"))},this.loading=!0,this.getTree().then((function(t){var a=t.data;if(a){e.treeData=a.data,e.treeData[0].show=!0,e.treeData=a.data,console.log(e.treeData),e.$emit("handleNodeClick",{modelGroupCode:e.treeData[0].modelGroupCode},a.data[0]);var n=e;e.$nextTick((function(){n.treeData.forEach((function(e){e.show&&(n.$refs.tree.setCurrentKey(e.code),console.log(n.$refs.tree),n.$refs.tree.store.nodesMap[e.code].expanded=!0)}))}))}})).finally((function(){e.loading=!1})),this.$bus.$on("appendTreeChild",this.appendChildren),this.$bus.$on("removeTreeChild",this.removeTreeChild),this.$bus.$on("changeTreeData",this.changeTreeData)},methods:{changeTreeData:function(e){var t=this.nodeData.children,a=this.nodeData.resolve,n=[];t.forEach((function(t){t.objId===e.objId?n.push(e):n.push(t)})),a(n)},appendChildren:function(e){var t=this.nodeData.children,a=this.nodeData.resolve,n=[];t.unshift(e.data),t.forEach((function(e){n.push(e)})),a(n)},removeTreeChild:function(e){var t=this.nodeData.children,a=this.nodeData.resolve,n=[];t.forEach((function(t){t.tenantGroupCode!=e.tenantGroupCode&&n.push(t)})),t.splice(t.findIndex((function(t){return t.tenantGroupCode==e.tenantGroupCode})),1),a(n)},handleNodeClick:function(e,t){this.nodeData=t,e.lev=t.level,2==e.belongLevel?this.$emit("handleNodeClick",{modelGroupCode:e.modelGroupCode},e):this.$emit("handleNodeClick",{modelCode:e.code,modelGroupCode:e.modelGroupCode},e)}}}),o=s,r=(a("63bd"),a("2877")),l=Object(r["a"])(o,n,i,!1,null,"58cabb5e",null);t["a"]=l.exports}}]);