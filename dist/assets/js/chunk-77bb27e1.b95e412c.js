(window["webpackJsonp_pms-framework-nx-umms-ui"]=window["webpackJsonp_pms-framework-nx-umms-ui"]||[]).push([["chunk-77bb27e1"],{"07ea":function(t,e,a){},"2f7c":function(t,e,a){"use strict";a("83e4")},5530:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");var s=a("ade3");function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){Object(s["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}},"617f":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-content"},[a("msui-datagrid",{ref:"msuiDatagrid",staticClass:"msui-datagrid",attrs:{options:t.datagridOptions},scopedSlots:t._u([t._l(t.$scopedSlots,(function(e,a){return{key:a,fn:function(e){return[t._t(a,null,null,e)]}}}))],null,!0)}),a("msui-pagination",{ref:"msuiPagination",staticClass:"table-page",attrs:{attrs:t.pageAttrs},on:{change:t.pageChange}})],1)},n=[],o=(a("99af"),a("498a"),a("d3b7"),{data:function(){return{pageAttrs:{currentPage:1,total:0,pageSize:10},datagridOptions:{}}},props:{url:{type:Object,default:function(){return{get:"",post:""}}},model:{type:Object,default:function(){return{}}},params:{type:Object,default:function(){return{}}}},mounted:function(){this.init(),this.initDatagrid(),this.$bus.$on("refreshDatagrid",this.load)},watch:{params:{handler:function(){this.load({currentPage:1,pageSize:this.pageAttrs.pageSize}),this.pageAttrs.currentPage=1},deep:!0},"model.data":{handler:function(){this.datagridOptions.data.unshift(this.model.data)}}},methods:{init:function(){this.initAxios()},getHeight:function(t){return t.$el.clientHeight},initDatagrid:function(){var t=this;this.datagridOptions={data:this.model.data,index:this.model.index||{indexMethod:function(e){return(t.pageAttrs.currentPage-1)*t.pageAttrs.pageSize+e+1}},selection:this.model.selection||!0,expand:this.model.expand||!1,datagridModel:this.model.datagridModel,globalButton:this.model.globalButton||[],inlineButton:this.model.inlineButton||[],attrs:{height:this.model.globalButton?this.getHeight(this.$refs.msuiDatagrid)-72:this.getHeight(this.$refs.msuiDatagrid)-24,loading:!1},datagridFunction:Object.assign(this.model.datagridFunction||{},{cellDblclick:function(e,a,s){if(console.log(s),!(s.children.length>1)){var n=a.property,o="table-edit",i=t.model.datagridModel[n],r=i.type,l=i.edit,c=document.createElement("div");l&&("text"!==r&&"select"!==r&&"timePicker"!==r||(s.firstChild.style.display="none",c.id=o,c.value=e[n],s.appendChild(c)),"text"===r?t.isInput(s,e,n,o):"select"===r?t.isSelect(s,e,n,o,i):"timePicker"===r&&t.isTimePicker(s,e,n,o))}}})}},initAxios:function(){var t=this;this.getList=function(e){return t.$http.get("".concat(t.$api.PRE).concat(t.url.get),{params:e})},this.postList=function(e){return t.$http.post("".concat(t.$api.PRE).concat(t.url.post),e)}},load:function(t){var e=this;t&&(t=Object.assign(t,this.params)),t=Object.assign({currentPage:this.pageAttrs.currentPage,pageSize:this.pageAttrs.pageSize},this.params),this.datagridOptions.attrs.loading=!0,this.getList(t).then((function(t){var a=t.data;e.$emit("changeData",a,e.datagridOptions,e.pageAttrs),e.datagridOptions.attrs.loading=!1}))},pageChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;this.load({pageSize:e,currentPage:t})},isInput:function(t,e,a,s){var n,o=this,i=new this.MsuiElement;i.template='<msui-input\n            style="width:75%;height: 24.9975px;"\n            ref="input"\n            :attrs="attrs"\n            v-if="showInput"\n            v-model="attrs.value"\n            @blur="blur"/>',n="请输入名称"==e[a]?"":e[a],i.data={showInput:!0,attrs:{value:n,placeholder:"请输入名称",size:"mini",maxLength:20}},i.mounted=function(){setTimeout((function(){r.$refs.input.focus()}),10)},i.methods={blur:function(){if(""!=i.MSUIVUEINS.attrs.value.trim()){i.MSUIVUEINS.showInput=!1,t.firstChild.style.display="block";var s=e[a];e.objId?(e[a]=i.MSUIVUEINS.attrs.value,o.MsuiMessage({text:"是否确定修改数据",errorMessage:"取消修改",successCallBack:function(){o.datagridOptions.attrs.loading=!0,o.postList(e).then((function(t){t.data.success?(o.$message({message:t.data.data,type:"success"}),o.$bus.$emit("changeTreeData",e)):(e[a]=s,o.$message({message:t.data.desc,type:"error"}))})).catch((function(t){o.$message({message:"修改失败",type:"error"}),e[a]=s})).finally((function(){o.datagridOptions.attrs.loading=!1}))},errorCallBack:function(){e[a]=s}})):(e[a]=i.MSUIVUEINS.attrs.value,o.$emit("setNewData",e,a,s,o.datagridOptions.attrs))}else o.$message({message:"输入的名称不能为空",type:"error"})}},i.render("#".concat(s));var r=i.MSUIVUEINS.$refs.input},isSelect:function(t,e,a,s,n){var o,i=new this.MsuiElement;i.template='<msui-select-box\n            style="width:75%;height: 24px;"\n            ref="select"\n            :attrs="attrs"\n            v-model="attrs.value"\n            @change="change"\n            v-if="show"/>',o="请输入名称"==e[a]?"":e[a],i.data={show:!0,attrs:{value:o,placeholder:"请输入名称",size:"mini",options:[]}},n.data instanceof Promise?n.data.then((function(t){i.data.attrs.options=t})):i.data.attrs.options=n.data,i.mounted=function(){setTimeout((function(){r.$refs.select.focus()}),10)},i.methods={change:function(s){e[a]=s,i.MSUIVUEINS.show=!1,t.firstChild.style.display="block"}},i.render("#".concat(s));var r=i.MSUIVUEINS.$refs.select},isTimePicker:function(t,e,a,s){var n=this,o=new this.MsuiElement;o.template='<msui-time-picker\n            style="width:75%;height: 24.9975px;"\n            ref="time"\n            :attrs="attrs"\n            v-if="show"\n            @blur="blur"/>',o.data={value:e[a],show:!0,attrs:{blur:function(){o.MSUIVUEINS.$refs.time.$emit("blur",o.MSUIVUEINS.$refs.time.value1)},size:"mini"}},o.mounted=function(){setTimeout((function(){o.MSUIVUEINS.$refs.time.$refs.time.focus()}),10)},o.methods={blur:function(e){var a=""===e?new Date:e,s=n.MsuiUtils.timestampToTime(a);console.log(s),o.MSUIVUEINS.show=!1,t.firstChild.style.display="block"}},o.render("#".concat(s))}}}),i=o,r=(a("2f7c"),a("2877")),l=Object(r["a"])(i,s,n,!1,null,"0f8da654",null);e["a"]=l.exports},"83e4":function(t,e,a){},8643:function(t,e,a){"use strict";a("07ea")},"8b46":function(t,e,a){},ab65:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"model-content"},[a("modelReleaseList",{staticClass:"model-right",attrs:{params:t.params}})],1)},n=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"table-header"},[a("msui-form",{ref:"form",attrs:{options:t.form},scopedSlots:t._u([{key:"save",fn:function(){return[a("el-form-item",{staticClass:"special-save"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.form.submitForm()}}},[t._v("查询")]),a("el-button",{on:{click:function(e){return t.$refs.form.resetForm()}}},[t._v("重置")])],1)]},proxy:!0}])})],1),a("model-list-core",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"listCore",attrs:{model:t.model,url:t.url,params:t.mergeParams},on:{changeData:t.changeData}}),a("msui-dialog",{ref:"msuiDialog",attrs:{options:t.currentDialogAttrs}},[a(t.currentDialogComponent,{ref:"componentsDialogRef",tag:"component",on:{closeDialog:t.closeDialog}})],1)],1)},i=[],r=a("5530"),l=(a("4de4"),a("d3b7"),a("d81d"),a("617f")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("msui-form",{ref:"form",attrs:{options:t.form},scopedSlots:t._u([{key:"save",fn:function(){return[a("el-col",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.form.submitForm()}}},[t._v("保存")]),a("el-button",{on:{click:function(e){return t.$refs.form.resetForm()}}},[t._v("取消")])],1)],1)]},proxy:!0}])})},u=[],d=(a("e9c4"),{data:function(){return{form:this.initForm({flowName:"流程名称",versionCode:"版本号",modelCode:"模型变更"}),formEdit:!1}},mounted:function(){var t=this;this.setNew=function(e){return t.$http.post("".concat(t.$api.PRE,"/modelrelease/AddMode"),e)},this.UpdateMode=function(e){return t.$http.post("".concat(t.$api.PRE,"/modelrelease/UpdateMode"),e)}},methods:{setData:function(t){var e=this;console.log(t),setTimeout((function(){var a=e.form.formModel.versionCode.getAttrs();a.options.push({label:t.versionNo,value:t.versionCode})}),100),this.formEdit=!0,this.data=JSON.parse(JSON.stringify(t)),this.data.flowUserName=this.$store.getters["username"],this.form.formModel.setData(this.data)},resetData:function(){this.form.formModel.setData({flowName:"",versionCode:"",modelCode:""})},initForm:function(t){var e=this;return console.log(t),t=new this.MsuiFormModel(t),t.flowName.addRules([{required:!0,message:"请输入流程名称",trigger:"blur"}]),t.versionCode.addRules([{required:!0,message:"请选择版本号",trigger:"blur"}]),t.modelCode.addRules([{required:!0,message:"请选择模型",trigger:"blur"}]),t.versionCode.type({placeholder:"请选择内容",options:this.$http.get("".concat(this.$api.PRE,"/modelrelease/ModeVersionList")).then((function(t){var e=t.data;if(e.data)return e.data.map((function(t){var e=t.versionNo,a=t.versionCode;return{label:e,value:a}}))}))},"MsuiSelectBox"),t.modelCode.type({placeholder:"请选择内容",options:this.$http.get("".concat(this.$api.PRE,"/modelrelease/ModeRList")).then((function(t){var e=t.data;if(e.data)return e.data.map((function(t){var e=t.modelName,a=t.modelCode;return{label:e,value:a}}))}))},"MsuiSelectBox"),{labelWidth:"100px",labelPosition:"right",size:"small",disabled:!1,formModel:t,inline:!1,showButton:!0,span:20,save:function(t){if(t.flowUserName=e.$store.getters["username"],e.formEdit){for(var a in e.editFlag=!1,t)t[a]!=e.data[a]&&(e.editFlag=!0);if(!1===e.editFlag)return void e.$message({type:"error",message:"请修改数据或取消修改"});t.flowCode=e.data.flowCode,e.UpdateMode(t).then((function(t){console.log(t.data),0==t.data.data?e.$message({type:"error",message:"修改的名称或版本号不能重复"}):(e.$message({type:"success",message:"修改成功"}),e.$emit("closeDialog","refresh"),e.formEdit=!1)}))}else e.setNew(t).then((function(t){0!=t.data.data?(e.$message({type:"success",message:"新增成功！"}),e.$emit("closeDialog","refresh")):e.$message({type:"error",message:"新增的数据已存在！"})}))},reset:function(){e.$emit("closeDialog")}}}}}),f=d,m=a("2877"),g=Object(m["a"])(f,c,u,!1,null,null,null),p=g.exports,h={components:{modelListCore:l["a"]},props:{params:{type:Object,default:function(){return{}}}},computed:{mergeParams:function(){return Object(r["a"])(Object(r["a"])({},this.params),this.paramsKeyword)}},data:function(){return{model:{},currentDialogComponent:p,currentDialogAttrs:{attrs:{title:"模型详情",showFoot:!1,center:!1,showClose:!0,destroyOnClose:!1}},form:this.initForm({flowName:"流程名称",flowStatus:"状态"}),loading:!1,paramsKeyword:{},url:{get:"/modelrelease/ModeList",post:""}}},created:function(){this.initModel({flowName:"流程名称",versionNo:"版本号",flowStatus:"状态",flowUserName:"创建人",flowCtime:"创建时间",pubTime:"发布时间"})},mounted:function(){var t=this;setTimeout((function(){t.$refs.listCore.load({currentPage:1})}),100),this.publishAxios=function(e){return t.$http.post("".concat(t.$api.PRE,"/modelrelease/ModelRelease"),e)},this.cancelPublishAxios=function(e){return t.$http.post("".concat(t.$api.PRE,"/modelrelease/NoModelRelease"),e)},this.deleteAxios=function(e){return t.$http.post("".concat(t.$api.PRE,"/modelrelease/Deletemode"),e)}},methods:{closeDialog:function(t){this.$refs.msuiDialog.close(),"refresh"===t&&this.$refs.listCore.load({currentPage:1})},refresh:function(){this.$refs.form.submitForm()},changeData:function(t,e,a){var s=t.data;e.data=s.list,a.total=s.total},initForm:function(t){var e=this;return t=new this.MsuiFormModel(t),t.flowName.type({placeholder:"请输入"}),t.flowStatus.type({options:[{value:0,label:"未发布"},{value:1,label:"发布"}]},"MsuiSelectBox"),{labelWidth:"75px",labelPosition:"right",size:"small",disabled:!1,formModel:t,inline:!0,save:function(t){e.paramsKeyword=t},reset:function(){e.paramsKeyword={}}}},initModel:function(t){var e=this,a=new this.MsuiDataGridModel({dataModel:t,align:"left"});a.flowStatus.formatter((function(t){switch(t){case"0":return"未发布";case"1":return"发布"}})),this.model={datagridModel:a,data:[],globalButton:[{title:"新增",type:"text",icon:"el-icon-circle-plus-outline",clickHandler:function(t){e.$refs.msuiDialog.open(),e.$nextTick((function(){e.currentDialogAttrs.attrs.title="新增",e.$refs.componentsDialogRef.form.showButton=!0,e.$refs.componentsDialogRef.form.disabled=!1,e.$refs.componentsDialogRef.resetData()}))}},{title:"删除",icon:"el-icon-delete",type:"text",clickHandler:function(t){var a=t.filter((function(t){return"1"==t.flowStatus}));t.length<=0?e.$message({type:"info",message:"请先选择数据"}):a.length>0?e.$message({type:"info",message:"禁止删除已发布的模型"}):e.MsuiMessage({text:"确定要删除".concat(t.length,"条数据吗？"),errorMessage:"取消删除",successCallBack:function(){var a=t.map((function(t){return t.flowCode}));e.$refs.listCore.datagridOptions.attrs.loading=!0,e.deleteAxios({flowCodes:a}).then((function(a){var s=a.data;s.status&&(e.$refs.listCore.load(),e.$message({message:"已成功删除".concat(t.length,"条"),type:"success"}))})).finally((function(){e.$refs.listCore.datagridOptions.attrs.loading=!1}))},errorCallBack:function(){}})}},{title:"发布",icon:"el-icon-upload2",type:"text",clickHandler:function(t){var a=t.filter((function(t){return"1"==t.flowStatus}));t.length<=0?e.$message({type:"info",message:"请先选择数据"}):a.length>0?e.$message({type:"info",message:"禁止发布已发布的模型"}):e.MsuiMessage({text:"确定要发布".concat(t.length,"条数据吗？"),errorMessage:"取消发布",successCallBack:function(){e.$refs.listCore.datagridOptions.attrs.loading=!0;var a=t.map((function(t){return t.flowCode}));e.publishAxios({flowCodes:a}).then((function(a){var s=a.data;s.status&&(e.$refs.listCore.load(),e.$message({message:"已成功发布".concat(t.length,"条"),type:"success"}))})).finally((function(){e.$refs.listCore.datagridOptions.attrs.loading=!1}))},errorCallBack:function(){}})}},{title:"取消发布",icon:"el-icon-circle-close",type:"text",clickHandler:function(t){var a=t.filter((function(t){return"0"==t.flowStatus}));t.length<=0?e.$message({type:"info",message:"请先选择数据"}):a.length>0?e.$message({type:"info",message:"禁止取消未发布的模型"}):e.MsuiMessage({text:"确定要取消发布".concat(t.length,"数据吗？"),errorMessage:"取消取消发布",successCallBack:function(){var a=t.map((function(t){return t.flowCode}));e.$refs.listCore.datagridOptions.attrs.loading=!0,e.cancelPublishAxios({flowCodes:a}).then((function(a){var s=a.data;s.status&&(e.$refs.listCore.load(),e.$message({message:"已成功取消发布".concat(t.length,"条"),type:"success"}))})).finally((function(){e.$refs.listCore.datagridOptions.attrs.loading=!1}))},errorCallBack:function(){}})}}],inlineButton:[{title:"修改",clickHandler:function(t,a){var s=t.row;t.$index;e.$refs.msuiDialog.open(),e.$nextTick((function(){e.currentDialogAttrs.attrs.title="修改",e.$refs.componentsDialogRef.resetData(),e.$refs.componentsDialogRef.form.showButton=!0,e.$refs.componentsDialogRef.setData(s)}))},visable:function(t){return"1"!=t.flowStatus}},{title:"查看",clickHandler:function(t,a){var s=t.row;t.$index;e.$refs.msuiDialog.open(),e.$nextTick((function(){e.currentDialogAttrs.attrs.title="查看",e.$refs.componentsDialogRef.resetData(),e.$refs.componentsDialogRef.setData(s),e.$refs.componentsDialogRef.form.showButton=!1,e.$refs.componentsDialogRef.form.disabled=!0}))}}],datagridFunction:{}}}}},b=h,v=(a("b041b"),Object(m["a"])(b,o,i,!1,null,"03d8ed02",null)),$=v.exports,w={components:{modelReleaseList:$},data:function(){return{params:{}}},methods:{handleNodeClick:function(t){this.params=t}}},y=w,C=(a("8643"),Object(m["a"])(y,s,n,!1,null,"650f42f6",null));e["default"]=C.exports},b041b:function(t,e,a){"use strict";a("8b46")},b64b:function(t,e,a){var s=a("23e7"),n=a("7b0b"),o=a("df75"),i=a("d039"),r=i((function(){o(1)}));s({target:"Object",stat:!0,forced:r},{keys:function(t){return o(n(t))}})},dbb4:function(t,e,a){var s=a("23e7"),n=a("83ab"),o=a("56ef"),i=a("fc6a"),r=a("06cf"),l=a("8418");s({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(t){var e,a,s=i(t),n=r.f,c=o(s),u={},d=0;while(c.length>d)a=n(s,e=c[d++]),void 0!==a&&l(u,e,a);return u}})},e439:function(t,e,a){var s=a("23e7"),n=a("d039"),o=a("fc6a"),i=a("06cf").f,r=a("83ab"),l=n((function(){i(1)})),c=!r||l;s({target:"Object",stat:!0,forced:c,sham:!r},{getOwnPropertyDescriptor:function(t,e){return i(o(t),e)}})}}]);