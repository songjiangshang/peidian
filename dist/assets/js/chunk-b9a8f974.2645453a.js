(window["webpackJsonp_pms-framework-nx-umms-ui"]=window["webpackJsonp_pms-framework-nx-umms-ui"]||[]).push([["chunk-b9a8f974"],{"2f7c":function(t,e,n){"use strict";n("83e4")},5530:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("b64b"),n("a4d3"),n("4de4"),n("d3b7"),n("e439"),n("159b"),n("dbb4");var s=n("ade3");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},"612c":function(t,e,n){"use strict";n.r(e);var s,i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"model-content"},[n("versionMangeList",{staticClass:"model-right",attrs:{params:t.params}})],1)},r=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"table-header"},[n("msui-form",{ref:"form",attrs:{options:t.form},scopedSlots:t._u([{key:"save",fn:function(){return[n("el-form-item",{staticClass:"special-save"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.form.submitForm()}}},[t._v("查询")]),n("el-button",{on:{click:function(e){return t.$refs.form.resetForm()}}},[t._v("重置")])],1)]},proxy:!0}])})],1),n("model-list-core",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"listCore",attrs:{model:t.model,url:t.url,params:t.mergeParams},on:{changeData:t.changeData}}),n("msui-dialog",{ref:"msuiDialog",attrs:{options:t.currentDialogAttrs}},[n(t.currentDialogComponent,{ref:"componentsDialogRef",tag:"component",on:{closeDialog:t.closeDialog}})],1)],1)},o=[],c=n("ade3"),l=n("5530"),u=(n("4de4"),n("d3b7"),n("d81d"),n("617f")),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("msui-form",{ref:"form",attrs:{options:t.form},scopedSlots:t._u([{key:"save",fn:function(){return[n("el-col",{staticStyle:{"text-align":"center"},attrs:{span:19}},[n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.form.submitForm()}}},[t._v("保存")]),n("el-button",{on:{click:function(e){return t.$refs.form.resetForm()}}},[t._v("取消")])],1)],1)]},proxy:!0}])})},f=[],m=(n("e9c4"),n("fb6a"),n("d9e2"),{data:function(){return{form:this.initForm({versionNo:"版本号",versionDesc:"版本说明"})}},mounted:function(){var t=this;this.setNew=function(e){return t.$http.post("".concat(t.$api.PRE,"/model-version/v1/create/versionManage"),e)},this.UpdateMode=function(e){return t.$http.post("".concat(t.$api.PRE,"/model-version/v1/update/versionManage"),e)}},methods:{setData:function(t){this.formEdit=!0,t=JSON.parse(JSON.stringify(t)),t.versionNo=t.versionNo.slice(1),console.log(t.versionNo),this.data=t,this.form.formModel.setData(t)},resetData:function(){this.form.formModel.setData({versionCode:"",versionDesc:""})},validateNumber:function(t,e,n){if(e*=1,e<0)return n(new Error("版本号必须大于0"));if(e>1e3)return n(new Error("版本号必须小于1000"));var s=String(e),i=0;for(var r in s)"."===s[r]&&i++;if(i>1)return n(new Error("请输入正确的数字"));var a=String(e).indexOf(".")+1;a<=0&&n();var o=String(e).length-a;if(o>1)return n(new Error("版本号小数点后只允许有一位"));n()},initForm:function(t){var e=this;return t=new this.MsuiFormModel(t),t.addRules([{required:!0,message:"请输入版本说明...",trigger:"blur"}]),t.versionDesc.type({rows:5,type:"textarea",placeholder:"请输入内容"}),t.versionNo.type({type:"number"}),t.versionNo.addRules([{validator:this.validateNumber,trigger:"blur",required:!0},{required:!0,message:"请输入正确的版本号",trigger:"blur"}]),{labelWidth:"100px",labelPosition:"right",size:"small",disabled:!1,formModel:t,inline:!1,showButton:!0,span:20,save:function(t){t.versionNo="V"+t.versionNo,t.userId=e.$store.getters["userId"],t.userName=e.$store.getters["username"],e.formEdit?(t.versionCode=e.data.versionCode,e.UpdateMode(t).then((function(t){t.data.status?(e.$message({type:"success",message:"修改成功"}),e.$emit("closeDialog","refresh"),e.formEdit=!1):e.$message({type:"error",message:t.data.message})}))):e.setNew(t).then((function(t){console.log(t.data),t.data.status?(e.$message({type:"success",message:"新增成功"}),e.$emit("closeDialog","refresh")):e.$message({type:"error",message:t.data.message})}))},reset:function(){e.$emit("closeDialog")}}}}}),g=m,p=n("2877"),h=Object(p["a"])(g,d,f,!1,null,null,null),v=h.exports,b={components:{modelListCore:u["a"]},props:{params:{type:Object,default:function(){return{}}}},computed:{mergeParams:function(){return Object(l["a"])(Object(l["a"])({},this.params),this.paramsKeyword)}},data:function(){return{model:{},currentDialogComponent:v,currentDialogAttrs:{attrs:{title:"模型详情",showFoot:!1}},loading:!1,paramsKeyword:{},form:this.initForm({versionNo:"版本号"}),url:{get:"/model-version/v1/get/versionManage/list",post:""}}},created:function(){this.initModel({versionNo:"版本号",versionDesc:"版本说明",status:"状态",userName:"创建人",ctime:"创建时间"})},mounted:function(){var t=this;this.$bus.$on("addSuccess",this.refresh),this.deleteAxios=function(e){return t.$http.post("".concat(t.$api.PRE,"/model-version/v1/delete/versionManage"),e)},setTimeout((function(){t.$refs.listCore.load({pageSize:10,currentPage:1})}),100)},methods:(s={closeDialog:function(){this.$refs.msuiDialog.close()},refresh:function(){this.$refs.form.submitForm()}},Object(c["a"])(s,"closeDialog",(function(t){this.$refs.msuiDialog.close(),"refresh"===t&&this.$refs.listCore.load({currentPage:1})})),Object(c["a"])(s,"initForm",(function(t){var e=this;return t=new this.MsuiFormModel(t),t.versionNo.type({placeholder:"请输入内容"}),{labelWidth:"75px",labelPosition:"right",size:"small",disabled:!1,formModel:t,inline:!0,save:function(t){e.paramsKeyword=t},reset:function(){e.paramsKeyword={}}}})),Object(c["a"])(s,"changeData",(function(t,e,n){var s=t.data;e.data=s.list,n.total=s.total})),Object(c["a"])(s,"initModel",(function(t){var e=this,n=new this.MsuiDataGridModel({dataModel:t,align:"left"});n.status.formatter((function(t){switch(t){case 0:return"未启用";case 1:return"启用"}})),this.model={datagridModel:n,data:[],globalButton:[{title:"新增",type:"text",icon:"el-icon-circle-plus-outline",clickHandler:function(t){e.$refs.msuiDialog.open(),e.$nextTick((function(){e.currentDialogAttrs.attrs.title="新增",e.$refs.componentsDialogRef.form.showButton=!0,e.$refs.componentsDialogRef.form.disabled=!1}))}},{title:"删除",icon:"el-icon-delete",type:"text",clickHandler:function(t){var n=t.filter((function(t){return 1==t.status}));t.length<=0?e.$message({type:"info",message:"请先选择数据"}):n.length>0?e.$message({type:"error",message:"禁止删除已启用的数据"}):e.MsuiMessage({text:"确定要删除".concat(t.length,"条数据吗？"),errorMessage:"取消删除",successCallBack:function(){var n=t.map((function(t){return t.objId}));e.$refs.listCore.datagridOptions.attrs.loading=!0,e.deleteAxios(n).then((function(n){var s=n.data;s.status&&(e.$refs.listCore.load(),e.$message({message:"已成功删除".concat(t.length,"条"),type:"success"}))})).finally((function(){e.$refs.listCore.datagridOptions.attrs.loading=!1}))},errorCallBack:function(){}})}}],inlineButton:[{title:"修改",clickHandler:function(t,n){var s=t.row;t.$index;1!==s.status?(e.$refs.msuiDialog.open(),e.$nextTick((function(){e.currentDialogAttrs.attrs.title="版本修改",e.$refs.componentsDialogRef.resetData(),e.$refs.componentsDialogRef.form.showButton=!0,e.$refs.componentsDialogRef.setData(s)}))):e.$message({message:"禁止修改已启用的数据",type:"error"})}},{title:"查看",clickHandler:function(t,n){var s=t.row;t.$index;e.$refs.msuiDialog.open(),e.$nextTick((function(){e.currentDialogAttrs.attrs.title="版本查看",e.$refs.componentsDialogRef.resetData(),e.$refs.componentsDialogRef.setData(s),e.$refs.componentsDialogRef.form.showButton=!1,e.$refs.componentsDialogRef.form.disabled=!0}))}}],datagridFunction:{}}})),s)},$=b,y=(n("e826"),Object(p["a"])($,a,o,!1,null,"6bc44b99",null)),D=y.exports,w={components:{versionMangeList:D},data:function(){return{params:{}}},methods:{handleNodeClick:function(t){this.params=t}}},O=w,M=(n("fdd3"),Object(p["a"])(O,i,r,!1,null,"1d99b769",null));e["default"]=M.exports},"617f":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"table-content"},[n("msui-datagrid",{ref:"msuiDatagrid",staticClass:"msui-datagrid",attrs:{options:t.datagridOptions},scopedSlots:t._u([t._l(t.$scopedSlots,(function(e,n){return{key:n,fn:function(e){return[t._t(n,null,null,e)]}}}))],null,!0)}),n("msui-pagination",{ref:"msuiPagination",staticClass:"table-page",attrs:{attrs:t.pageAttrs},on:{change:t.pageChange}})],1)},i=[],r=(n("99af"),n("498a"),n("d3b7"),{data:function(){return{pageAttrs:{currentPage:1,total:0,pageSize:10},datagridOptions:{}}},props:{url:{type:Object,default:function(){return{get:"",post:""}}},model:{type:Object,default:function(){return{}}},params:{type:Object,default:function(){return{}}}},mounted:function(){this.init(),this.initDatagrid(),this.$bus.$on("refreshDatagrid",this.load)},watch:{params:{handler:function(){this.load({currentPage:1,pageSize:this.pageAttrs.pageSize}),this.pageAttrs.currentPage=1},deep:!0},"model.data":{handler:function(){this.datagridOptions.data.unshift(this.model.data)}}},methods:{init:function(){this.initAxios()},getHeight:function(t){return t.$el.clientHeight},initDatagrid:function(){var t=this;this.datagridOptions={data:this.model.data,index:this.model.index||{indexMethod:function(e){return(t.pageAttrs.currentPage-1)*t.pageAttrs.pageSize+e+1}},selection:this.model.selection||!0,expand:this.model.expand||!1,datagridModel:this.model.datagridModel,globalButton:this.model.globalButton||[],inlineButton:this.model.inlineButton||[],attrs:{height:this.model.globalButton?this.getHeight(this.$refs.msuiDatagrid)-72:this.getHeight(this.$refs.msuiDatagrid)-24,loading:!1},datagridFunction:Object.assign(this.model.datagridFunction||{},{cellDblclick:function(e,n,s){if(console.log(s),!(s.children.length>1)){var i=n.property,r="table-edit",a=t.model.datagridModel[i],o=a.type,c=a.edit,l=document.createElement("div");c&&("text"!==o&&"select"!==o&&"timePicker"!==o||(s.firstChild.style.display="none",l.id=r,l.value=e[i],s.appendChild(l)),"text"===o?t.isInput(s,e,i,r):"select"===o?t.isSelect(s,e,i,r,a):"timePicker"===o&&t.isTimePicker(s,e,i,r))}}})}},initAxios:function(){var t=this;this.getList=function(e){return t.$http.get("".concat(t.$api.PRE).concat(t.url.get),{params:e})},this.postList=function(e){return t.$http.post("".concat(t.$api.PRE).concat(t.url.post),e)}},load:function(t){var e=this;t&&(t=Object.assign(t,this.params)),t=Object.assign({currentPage:this.pageAttrs.currentPage,pageSize:this.pageAttrs.pageSize},this.params),this.datagridOptions.attrs.loading=!0,this.getList(t).then((function(t){var n=t.data;e.$emit("changeData",n,e.datagridOptions,e.pageAttrs),e.datagridOptions.attrs.loading=!1}))},pageChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;this.load({pageSize:e,currentPage:t})},isInput:function(t,e,n,s){var i,r=this,a=new this.MsuiElement;a.template='<msui-input\n            style="width:75%;height: 24.9975px;"\n            ref="input"\n            :attrs="attrs"\n            v-if="showInput"\n            v-model="attrs.value"\n            @blur="blur"/>',i="请输入名称"==e[n]?"":e[n],a.data={showInput:!0,attrs:{value:i,placeholder:"请输入名称",size:"mini",maxLength:20}},a.mounted=function(){setTimeout((function(){o.$refs.input.focus()}),10)},a.methods={blur:function(){if(""!=a.MSUIVUEINS.attrs.value.trim()){a.MSUIVUEINS.showInput=!1,t.firstChild.style.display="block";var s=e[n];e.objId?(e[n]=a.MSUIVUEINS.attrs.value,r.MsuiMessage({text:"是否确定修改数据",errorMessage:"取消修改",successCallBack:function(){r.datagridOptions.attrs.loading=!0,r.postList(e).then((function(t){t.data.success?(r.$message({message:t.data.data,type:"success"}),r.$bus.$emit("changeTreeData",e)):(e[n]=s,r.$message({message:t.data.desc,type:"error"}))})).catch((function(t){r.$message({message:"修改失败",type:"error"}),e[n]=s})).finally((function(){r.datagridOptions.attrs.loading=!1}))},errorCallBack:function(){e[n]=s}})):(e[n]=a.MSUIVUEINS.attrs.value,r.$emit("setNewData",e,n,s,r.datagridOptions.attrs))}else r.$message({message:"输入的名称不能为空",type:"error"})}},a.render("#".concat(s));var o=a.MSUIVUEINS.$refs.input},isSelect:function(t,e,n,s,i){var r,a=new this.MsuiElement;a.template='<msui-select-box\n            style="width:75%;height: 24px;"\n            ref="select"\n            :attrs="attrs"\n            v-model="attrs.value"\n            @change="change"\n            v-if="show"/>',r="请输入名称"==e[n]?"":e[n],a.data={show:!0,attrs:{value:r,placeholder:"请输入名称",size:"mini",options:[]}},i.data instanceof Promise?i.data.then((function(t){a.data.attrs.options=t})):a.data.attrs.options=i.data,a.mounted=function(){setTimeout((function(){o.$refs.select.focus()}),10)},a.methods={change:function(s){e[n]=s,a.MSUIVUEINS.show=!1,t.firstChild.style.display="block"}},a.render("#".concat(s));var o=a.MSUIVUEINS.$refs.select},isTimePicker:function(t,e,n,s){var i=this,r=new this.MsuiElement;r.template='<msui-time-picker\n            style="width:75%;height: 24.9975px;"\n            ref="time"\n            :attrs="attrs"\n            v-if="show"\n            @blur="blur"/>',r.data={value:e[n],show:!0,attrs:{blur:function(){r.MSUIVUEINS.$refs.time.$emit("blur",r.MSUIVUEINS.$refs.time.value1)},size:"mini"}},r.mounted=function(){setTimeout((function(){r.MSUIVUEINS.$refs.time.$refs.time.focus()}),10)},r.methods={blur:function(e){var n=""===e?new Date:e,s=i.MsuiUtils.timestampToTime(n);console.log(s),r.MSUIVUEINS.show=!1,t.firstChild.style.display="block"}},r.render("#".concat(s))}}}),a=r,o=(n("2f7c"),n("2877")),c=Object(o["a"])(a,s,i,!1,null,"0f8da654",null);e["a"]=c.exports},"83e4":function(t,e,n){},b64b:function(t,e,n){var s=n("23e7"),i=n("7b0b"),r=n("df75"),a=n("d039"),o=a((function(){r(1)}));s({target:"Object",stat:!0,forced:o},{keys:function(t){return r(i(t))}})},bdcb:function(t,e,n){},dbb4:function(t,e,n){var s=n("23e7"),i=n("83ab"),r=n("56ef"),a=n("fc6a"),o=n("06cf"),c=n("8418");s({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){var e,n,s=a(t),i=o.f,l=r(s),u={},d=0;while(l.length>d)n=i(s,e=l[d++]),void 0!==n&&c(u,e,n);return u}})},e40f:function(t,e,n){},e439:function(t,e,n){var s=n("23e7"),i=n("d039"),r=n("fc6a"),a=n("06cf").f,o=n("83ab"),c=i((function(){a(1)})),l=!o||c;s({target:"Object",stat:!0,forced:l,sham:!o},{getOwnPropertyDescriptor:function(t,e){return a(r(t),e)}})},e826:function(t,e,n){"use strict";n("bdcb")},fdd3:function(t,e,n){"use strict";n("e40f")}}]);